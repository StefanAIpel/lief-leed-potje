<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beheer - Lief & Leed Potje</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <meta name="theme-color" content="#1a2744">
</head>
<body>
    <div class="container">
        <!-- Login Screen -->
        <div id="login-screen" class="login-screen">
            <div class="login-card">
                <div class="login-header">
                    <div class="street-sign-small">
                        <span>Straat Ambassadeurs</span>
                    </div>
                    <h1>Beheer Dashboard</h1>
                    <p>Lief & Leed Potje</p>
                </div>
                <form id="login-form" class="login-form">
                    <div class="form-group">
                        <label for="pin-input">PIN code</label>
                        <input type="password" 
                               id="pin-input" 
                               name="pin" 
                               maxlength="6" 
                               pattern="[0-9]*" 
                               inputmode="numeric"
                               placeholder="â€¢â€¢â€¢â€¢"
                               autocomplete="off"
                               required>
                        <p class="field-hint">Alleen voor kerngroepleden en beheerders</p>
                    </div>
                    <div id="login-error" class="login-error hidden">
                        âŒ Onjuiste PIN code. Probeer opnieuw.
                    </div>
                    <button type="submit" class="btn btn-gold btn-full">
                        <span>ğŸ”“</span> Inloggen
                    </button>
                </form>
                <div class="login-footer">
                    <a href="index.html">â† Terug naar aanvragen</a>
                </div>
            </div>
        </div>

        <!-- Admin Content (hidden until authenticated) -->
        <div id="admin-content" class="hidden">
            <header>
                <div class="logo">
                    <div class="street-sign">
                        <h1>Straat Ambassadeurs</h1>
                    </div>
                    <div class="header-info">
                        <span class="title">Beheer Dashboard</span>
                        <span class="subtitle">Vathorst & Hooglanderveen</span>
                    </div>
                </div>
                <nav>
                    <a href="index.html">Aanvragen</a>
                    <a href="admin.html" class="active">Beheer</a>
                    <button onclick="logout()" class="btn btn-secondary btn-small">
                        ğŸšª Uitloggen
                    </button>
                </nav>
            </header>

            <main class="admin-main">
                <!-- Tab Navigation -->
                <div class="tab-nav">
                    <button class="tab-btn active" onclick="switchTab('dashboard')">
                        ğŸ“Š Dashboard
                    </button>
                    <button class="tab-btn" onclick="switchTab('aanvragen')">
                        ğŸ“‹ Aanvragen
                    </button>
                    <button class="tab-btn" onclick="switchTab('ambassadeurs')">
                        ğŸ‘¥ Ambassadeurs
                    </button>
                </div>

                <!-- TAB: Dashboard -->
                <div id="tab-dashboard" class="tab-content active">
                    <section class="admin-header">
                        <h2>ğŸ“Š Budget Overzicht</h2>
                        <div class="admin-actions">
                            <button onclick="exportToExcel()" class="btn btn-secondary">
                                <span>ğŸ“¥</span> Export Excel
                            </button>
                            <button onclick="toggleBudgetSettings()" class="btn btn-secondary">
                                <span>âš™ï¸</span> Instellingen
                            </button>
                        </div>
                    </section>

                    <!-- Budget overzicht -->
                    <section class="budget-section">
                        <div class="budget-grid">
                            <div class="budget-card">
                                <div class="budget-icon">ğŸ’°</div>
                                <div class="budget-info">
                                    <div class="budget-label">Totaal Budget <span id="budget-jaar"></span></div>
                                    <div class="budget-value" id="budget-totaal">â‚¬0</div>
                                </div>
                            </div>
                            <div class="budget-card budget-uitgekeerd">
                                <div class="budget-icon">âœ…</div>
                                <div class="budget-info">
                                    <div class="budget-label">Uitgekeerd</div>
                                    <div class="budget-value" id="budget-uitgekeerd">â‚¬0</div>
                                </div>
                            </div>
                            <div class="budget-card budget-openstaand">
                                <div class="budget-icon">â³</div>
                                <div class="budget-info">
                                    <div class="budget-label">In behandeling</div>
                                    <div class="budget-value" id="budget-openstaand">â‚¬0</div>
                                </div>
                            </div>
                            <div class="budget-card budget-resterend">
                                <div class="budget-icon">ğŸ“Š</div>
                                <div class="budget-info">
                                    <div class="budget-label">Resterend</div>
                                    <div class="budget-value" id="budget-resterend">â‚¬0</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Budget progress bar -->
                        <div class="budget-progress">
                            <div class="progress-bar">
                                <div class="progress-uitgekeerd" id="progress-uitgekeerd"></div>
                                <div class="progress-openstaand" id="progress-openstaand"></div>
                            </div>
                            <div class="progress-labels">
                                <span><span class="dot dot-uitgekeerd"></span> Uitgekeerd</span>
                                <span><span class="dot dot-openstaand"></span> In behandeling</span>
                                <span><span class="dot dot-resterend"></span> Beschikbaar</span>
                            </div>
                        </div>
                    </section>

                    <!-- Budget settings -->
                    <section id="budget-settings" class="budget-settings hidden">
                        <h3>âš™ï¸ Instellingen</h3>
                        <div class="settings-grid">
                            <div class="settings-form">
                                <div class="form-group">
                                    <label for="jaarbudget">Jaarbudget (â‚¬)</label>
                                    <input type="number" id="jaarbudget" value="5000" min="0" step="100">
                                </div>
                                <button onclick="saveBudgetSettings()" class="btn btn-gold btn-small">Budget opslaan</button>
                            </div>
                            <div class="settings-form">
                                <div class="form-group">
                                    <label for="new-pin">Nieuwe PIN code</label>
                                    <input type="password" id="new-pin" maxlength="6" pattern="[0-9]*" inputmode="numeric" placeholder="Nieuwe PIN">
                                </div>
                                <button onclick="changePin()" class="btn btn-secondary btn-small">PIN wijzigen</button>
                            </div>
                        </div>
                    </section>

                    <!-- Quick Stats -->
                    <section class="stats-section">
                        <h3>ğŸ“ˆ Statistieken dit jaar</h3>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-number" id="stat-totaal">0</div>
                                <div class="stat-label">Aanvragen totaal</div>
                            </div>
                            <div class="stat-card stat-nieuw">
                                <div class="stat-number" id="stat-nieuw">0</div>
                                <div class="stat-label">Nieuw</div>
                            </div>
                            <div class="stat-card stat-behandeling">
                                <div class="stat-number" id="stat-behandeling">0</div>
                                <div class="stat-label">In behandeling</div>
                            </div>
                            <div class="stat-card stat-uitgekeerd">
                                <div class="stat-number" id="stat-uitgekeerd">0</div>
                                <div class="stat-label">Uitgekeerd</div>
                            </div>
                        </div>
                    </section>

                    <!-- Recente aanvragen -->
                    <section class="recent-section">
                        <h3>ğŸ†• Actie vereist</h3>
                        <div id="recent-aanvragen"></div>
                    </section>
                </div>

                <!-- TAB: Aanvragen -->
                <div id="tab-aanvragen" class="tab-content">
                    <section class="admin-header">
                        <h2>ğŸ“‹ Alle Aanvragen</h2>
                        <div class="admin-actions">
                            <button onclick="exportToExcel()" class="btn btn-secondary">
                                <span>ğŸ“¥</span> Export Excel
                            </button>
                        </div>
                    </section>

                    <!-- Filter sectie -->
                    <section class="filter-section">
                        <div class="filter-group">
                            <label for="filter-status">Status:</label>
                            <select id="filter-status" onchange="filterAanvragen()">
                                <option value="alle">Alle</option>
                                <option value="nieuw">ğŸ†• Nieuw</option>
                                <option value="in_behandeling">â³ In behandeling</option>
                                <option value="uitgekeerd">âœ… Uitgekeerd</option>
                                <option value="afgewezen">âŒ Afgewezen</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="filter-jaar">Jaar:</label>
                            <select id="filter-jaar" onchange="filterAanvragen()">
                                <option value="alle">Alle jaren</option>
                                <option value="2025" selected>2025</option>
                                <option value="2024">2024</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="filter-straat">Straat:</label>
                            <select id="filter-straat" onchange="filterAanvragen()">
                                <option value="alle">Alle straten</option>
                            </select>
                        </div>
                        <div class="filter-group filter-search">
                            <label for="search">Zoeken:</label>
                            <input type="text" id="search" placeholder="Naam, straat of referentie..." oninput="filterAanvragen()">
                        </div>
                    </section>

                    <!-- Aanvragen tabel -->
                    <section class="table-section">
                        <div class="table-responsive">
                            <table class="data-table" id="aanvragen-table">
                                <thead>
                                    <tr>
                                        <th onclick="sortTable('datum')" class="sortable">Datum â†•</th>
                                        <th onclick="sortTable('ambassadeurNaam')" class="sortable">Ambassadeur â†•</th>
                                        <th onclick="sortTable('straat')" class="sortable">Straat â†•</th>
                                        <th>Doel</th>
                                        <th onclick="sortTable('status')" class="sortable">Status â†•</th>
                                        <th>Bedrag</th>
                                        <th>Acties</th>
                                    </tr>
                                </thead>
                                <tbody id="aanvragen-tbody">
                                </tbody>
                            </table>
                        </div>
                        <div id="no-aanvragen" class="empty-state hidden">
                            Geen aanvragen gevonden.
                        </div>
                    </section>
                </div>

                <!-- TAB: Ambassadeurs -->
                <div id="tab-ambassadeurs" class="tab-content">
                    <section class="admin-header">
                        <h2>ğŸ‘¥ Straatambassadeurs</h2>
                        <div class="admin-actions">
                            <button onclick="exportAmbassadeursToExcel()" class="btn btn-secondary">
                                <span>ğŸ“¥</span> Export Excel
                            </button>
                        </div>
                    </section>

                    <!-- Zoek ambassadeurs -->
                    <section class="filter-section">
                        <div class="filter-group filter-search">
                            <label for="search-ambassadeur">Zoeken:</label>
                            <input type="text" id="search-ambassadeur" placeholder="Naam of straat..." oninput="filterAmbassadeurs()">
                        </div>
                        <div class="filter-group">
                            <label for="filter-amb-status">Toon:</label>
                            <select id="filter-amb-status" onchange="filterAmbassadeurs()">
                                <option value="alle">Alle ambassadeurs</option>
                                <option value="met-aanvraag">Met aanvraag dit jaar</option>
                                <option value="zonder-aanvraag">Zonder aanvraag dit jaar</option>
                            </select>
                        </div>
                    </section>

                    <!-- Ambassadeurs tabel -->
                    <section class="table-section">
                        <div class="table-responsive">
                            <table class="data-table" id="ambassadeurs-table">
                                <thead>
                                    <tr>
                                        <th onclick="sortAmbassadeursTable('code')" class="sortable">Code â†•</th>
                                        <th onclick="sortAmbassadeursTable('naam')" class="sortable">Naam â†•</th>
                                        <th onclick="sortAmbassadeursTable('straat')" class="sortable">Straat â†•</th>
                                        <th onclick="sortAmbassadeursTable('aanvragenJaar')" class="sortable">Dit jaar â†•</th>
                                        <th onclick="sortAmbassadeursTable('totaalUitgekeerd')" class="sortable">Uitgekeerd â†•</th>
                                        <th>Laatste</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="ambassadeurs-tbody">
                                </tbody>
                            </table>
                        </div>
                    </section>

                    <!-- Ambassadeurs stats -->
                    <section class="amb-stats">
                        <div class="amb-stat">
                            <strong id="amb-totaal">0</strong> ambassadeurs
                        </div>
                        <div class="amb-stat">
                            <strong id="amb-actief">0</strong> met aanvraag
                        </div>
                        <div class="amb-stat">
                            <strong id="amb-inactief">0</strong> nog geen aanvraag
                        </div>
                    </section>
                </div>

                <!-- Detail modal -->
                <div id="detail-modal" class="modal hidden">
                    <div class="modal-content">
                        <button class="modal-close" onclick="closeModal()">&times;</button>
                        <div id="modal-body"></div>
                    </div>
                </div>
            </main>

            <footer>
                <div class="delft-pattern"></div>
                <p>Â© 2025 Straatambassadeurs Vathorst & Hooglanderveen</p>
                <p style="margin-top: var(--space-xs); font-size: 0.8rem;">Beheer: Stefan Dijkstra</p>
            </footer>
        </div>
    </div>

    <script src="app.js"></script>
    <script src="admin.js"></script>
</body>
</html>
