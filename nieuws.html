<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nieuws - Straatambassadeurs Vathorst & Hooglanderveen | Amersfoort</title>
    <link rel="stylesheet" href="styles.css?v=20260208b">
    <meta name="theme-color" content="#1a2744">
    <meta name="description" content="Laatste nieuws van straatambassadeurs Vathorst & Hooglanderveen. Burendag, buurtactiviteiten en updates uit Amersfoort.">
    <meta name="keywords" content="straatambassadeurs, Vathorst, Hooglanderveen, VathetVeen, Amersfoort, Amersfoort Noord, burendag, buren, buurt, wijkkrant, buurtbudget, lief en leed, kerngroep, buurtverbinding, buurtinitiatieven, wijkactiviteiten, bewonersinitiatieven, sociale cohesie, leefbaarheid, Oranjefonds, NLdoet, gemeente Amersfoort, Bovenduist, Waterdorp, De Laak, De Bron, indebuurt033">
    <meta property="og:title" content="Nieuws - Straatambassadeurs Vathorst & Hooglanderveen">
    <meta property="og:description" content="Buurtnieuws, Burendag activiteiten en updates van de straatambassadeurs in Vathorst en Hooglanderveen.">
    <meta property="og:url" content="https://straatambassadeurs.nl/nieuws.html">
    <meta property="og:image" content="https://straatambassadeurs.nl/logo.jpg">
    <link rel="canonical" href="https://straatambassadeurs.nl/nieuws.html">
    <link rel="icon" href="favicon.png">
    <style>
        /* Nieuws dynamic styles */
        .news-card-clickable { cursor: pointer; }
        .news-card-expand {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease, padding 0.3s ease;
            padding: 0 24px;
        }
        .news-card-expand.open {
            max-height: 2000px;
            padding: 0 24px 20px;
        }
        .news-card-expand-inner {
            padding-top: 16px;
            border-top: 1px solid var(--gray-200);
        }
        .news-card-expand-inner p {
            font-size: 0.9rem;
            color: var(--gray-600);
            line-height: 1.7;
            margin-bottom: 10px;
        }
        .news-card-toggle {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            font-size: 0.82rem;
            font-weight: 600;
            color: var(--street-blue);
            cursor: pointer;
            background: none;
            border: none;
            padding: 6px 0;
            transition: color 0.2s;
        }
        .news-card-toggle:hover { color: var(--night-blue); }
        .news-card-toggle .arrow {
            display: inline-block;
            transition: transform 0.3s;
            font-size: 0.7rem;
        }
        .news-card-toggle.open .arrow { transform: rotate(180deg); }
        .news-card-image-top {
            width: 100%;
            height: 220px;
            object-fit: cover;
            display: block;
        }
        .news-loading {
            text-align: center;
            padding: 40px 20px;
            color: var(--gray-400);
            font-size: 0.9rem;
        }
        .news-loading .spinner {
            display: inline-block;
            width: 24px;
            height: 24px;
            border: 3px solid var(--gray-200);
            border-top-color: var(--street-blue);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin-bottom: 8px;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .news-auteur-badge {
            display: inline-block;
            background: var(--gray-100);
            color: var(--gray-600);
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.72rem;
            font-weight: 600;
        }
    </style>
</head>
<body>
        <header>
            <div class="header-content">
                <a href="index.html" class="logo" style="text-decoration:none;">
                    <picture><source media="(max-width: 600px)" srcset="images/logo-square.png"><img src="images/logo-header-new.png" alt="Straatambassadeurs" class="logo-img"></picture>
                    <div>
                        <div class="header-title">Vathorst &<br>Hooglanderveen</div>
                        <div class="header-subtitle">Samen maken we<br>de buurt mooier!</div>
                    </div>
                </a>
                <button class="nav-toggle" onclick="document.querySelector('nav').classList.toggle('active')" aria-label="Menu"><span class="nav-toggle-label">MENU</span> ‚ò∞</button>
                <nav>
                    <a href="index.html">Home</a>
                    <a href="nieuws.html" class="active">Nieuws</a>
                    <a href="kaart.html">Kaart</a>
                    <div class="nav-dropdown">
                        <a href="over-sa.html" class="nav-dropdown-toggle">Ambassadeurs ‚ñæ</a>
                        <div class="nav-dropdown-menu">
                            <a href="over-sa.html">Informatie</a>
                            <a href="aanmelden.html">Aanmelden</a>
                            <a href="potje-aanvragen.html">Potje aanvragen</a>
                            <a href="potje-afrekenen.html">Potje afrekenen</a>
                            <hr style="margin:6px 8px;border:none;border-top:1px solid rgba(0,0,0,0.1);">
                            <a href="handleiding.html">üìñ Handleiding</a>
                        </div>
                    </div>
                    <a href="over-kerngroep.html">Kerngroep</a>
                    <a href="contact.html">Contact</a>
                    <a href="admin.html">Beheer</a>
                </nav>
                <button class="sidebar-toggle" onclick="openSidebar()" aria-label="Alle pagina's">‚ò∞</button>
                <a href="handleiding.html" title="Handleiding" style="display:inline-flex;align-items:center;justify-content:center;width:32px;height:32px;border-radius:50%;background:rgba(255,255,255,0.15);color:white;text-decoration:none;font-size:16px;margin-right:6px;flex-shrink:0;">‚ùì</a>
                <div class="header-search">
                    <input type="text" id="site-search" placeholder="Zoeken..." autocomplete="off">
                    <div id="search-results" class="search-results"></div>
                </div>
            </div>
        </header>

        <div class="container">
        <main>
            <section class="hero">
                <div>
                    <h2>üì∞ Nieuws</h2>
                    <p>Het laatste nieuws van de Straatambassadeurs</p>
                </div>
            </section>

            <!-- Dynamic news from Supabase -->
            <div id="news-loading" class="news-loading">
                <div class="spinner"></div>
                <div>Nieuws laden...</div>
            </div>

            <div id="news-feed-dynamic" class="news-feed" style="display: none;"></div>

            <!-- Static fallback content (shown if no DB articles) -->
            <div id="news-feed-static" class="news-feed" style="display: none;">

                <!-- Nieuwsbericht: Inspiratiebijeenkomst Indebuurt033 -->
                <article class="news-card" id="inspiratiebijeenkomst">
                    <div class="news-card-body">
                        <span class="news-card-date">üìÖ Aankondiging ¬∑ april 2026</span>
                        <h3 class="news-card-title">üåü Inspiratiebijeenkomst Straatambassadeurs</h3>
                        <div class="news-card-text">
                            <p>De gemeente Amersfoort (Indebuurt033) organiseert een inspiratiebijeenkomst om idee√´n op te doen en elkaar te versterken in ons werk in de wijken.</p>
                        </div>
                        <div class="event-info">
                            <h4>üìã Praktische informatie</h4>
                            <p>üìÖ <strong>Wanneer:</strong> Woensdag 15 april 2026</p>
                            <p>üï¢ <strong>Tijd:</strong> 19:30 - 21:00 uur (inloop 19:15)</p>
                            <p>üìç <strong>Waar:</strong> Bij Bosshardt, Neptunusplein 66K, Amersfoort</p>
                            <p>‚úâÔ∏è <strong>Aanmelden:</strong> V√≥√≥r 8 april bij monique.duurland@indebuurt033.nl</p>
                        </div>
                        <a href="mailto:monique.duurland@indebuurt033.nl?subject=Aanmelding inspiratiebijeenkomst 15 april" 
                           class="btn-cta">‚úâÔ∏è Nu aanmelden</a>
                        <div class="news-card-meta">
                            <span class="news-card-tag">Bijeenkomst</span>
                            <span>Indebuurt033 ¬∑ Gemeente Amersfoort</span>
                        </div>
                    </div>
                </article>

                <!-- Nieuwsbericht: Nieuwjaarsborrel met hero image -->
                <article class="news-card news-card-featured" id="nieuwjaarsborrel">
                    <div class="news-hero-image">
                        <img src="images/nieuwjaarsborrel-banner.jpg" alt="Nieuwjaarsborrel Straatambassadeurs bij Bij Lot" class="news-hero-img">
                        <div class="news-hero-overlay">
                            <span class="news-hero-tag">üéâ Verslag</span>
                            <h3 class="news-hero-title">Geslaagde Nieuwjaarsborrel bij Bij Lot</h3>
                            <span class="news-hero-date">14 januari 2026</span>
                        </div>
                    </div>
                    <div class="news-card-body">
                        <div class="news-card-text">
                            <p>Op woensdag 14 januari kwamen de straatambassadeurs van Vathorst en Hooglanderveen 
                            samen voor een gezellige nieuwjaarsborrel bij <strong>Bij Lot</strong> aan de Hogesteeg. 
                            Het was een warme en inspirerende avond vol goede gesprekken en nieuwe verbindingen.</p>

                            <p>De avond stond in het teken van het belang van straatambassadeurs in de wijk en 
                            de mogelijkheden van het <strong>Lief & Leed potje</strong>.</p>
                        </div>

                        <div class="highlight-box">
                            <h4>‚ú® Inspirerend verhaal van Bart Viester</h4>
                            <p>Bij Lot biedt werkplekken aan mensen met een afstand tot de arbeidsmarkt. 
                            Een prachtig voorbeeld van sociale ondernemerschap in onze wijk!</p>
                        </div>

                        <div class="news-card-text">
                            <p>Ook <strong>Mehmet Kaya</strong>, gebiedsmanager van de gemeente Amersfoort, 
                            was aanwezig en benadrukte het belang van buurtverbinding.</p>
                        </div>

                        <div class="news-gallery">
                            <img src="images/nieuwjaarsborrel-1.jpg" alt="Straatambassadeurs bij Bij Lot">
                            <img src="images/nieuwjaarsborrel-2.jpg" alt="Gezellig netwerken">
                        </div>

                        <div class="news-card-meta">
                            <span class="news-card-tag">Verslag</span>
                            <span>üìç Bij Lot, Hogesteeg 63, Amersfoort</span>
                        </div>
                    </div>
                </article>

            </div>
        </main>
        </div>

        <footer class="footer-pro">
            <div class="footer-tagline">Van de straat, voor de straat üß°</div>
            <div class="footer-domain">straatambassadeurs.nl</div>
            <div class="footer-links" style="margin-bottom:6px; font-size:0.72rem;"><a href="mailto:info@straatambassadeurs.nl" style="color:rgba(255,255,255,0.7); text-decoration:none;">‚úâÔ∏è info@straatambassadeurs.nl</a></div>
            <div class="footer-links" style="margin-bottom:4px;font-size:0.72rem;"><a href="handleiding.html" style="color:rgba(255,255,255,0.7);text-decoration:none;">‚ùì Hulp nodig? Bekijk de handleiding</a></div>
        <div class="footer-copy">¬© 2026 Straatambassadeurs Vathorst &amp; Hooglanderveen ¬∑ Een initiatief van bewoners</div>
        </footer>
    <!-- Lightbox Modal -->
    <div class="lightbox" id="lightbox">
        <span class="lightbox-close">&times;</span>
        <img src="" alt="Vergroot" id="lightbox-img">
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
    <script src="supabase-config.js"></script>
    <script>
        // Dutch month names for date formatting
        const MAANDEN = ['januari', 'februari', 'maart', 'april', 'mei', 'juni',
                         'juli', 'augustus', 'september', 'oktober', 'november', 'december'];

        function formatDutchDate(dateStr) {
            if (!dateStr) return '';
            const d = new Date(dateStr);
            return `${d.getDate()} ${MAANDEN[d.getMonth()]} ${d.getFullYear()}`;
        }

        // Convert plain text to simple HTML (newlines to paragraphs)
        function textToHtml(text) {
            if (!text) return '';
            // Split on double newlines for paragraphs, single newlines for line breaks
            return text
                .split(/\n\n+/)
                .map(para => `<p>${para.replace(/\n/g, '<br>')}</p>`)
                .join('');
        }

        // Build a single news card HTML
        function buildNewsCard(article) {
            const hasImage = article.afbeelding_url && article.afbeelding_url.trim();
            const dateFormatted = formatDutchDate(article.created_at);
            const id = `news-${article.id}`;

            let imageHtml = '';
            if (hasImage) {
                imageHtml = `<img src="${article.afbeelding_url}" alt="${article.titel}" class="news-card-image-top" loading="lazy">`;
            }

            const summaryHtml = article.samenvatting
                ? `<div class="news-card-text"><p>${article.samenvatting}</p></div>`
                : '';

            const fullContentHtml = article.inhoud
                ? `<div class="news-card-expand" id="${id}-expand">
                       <div class="news-card-expand-inner">
                           ${textToHtml(article.inhoud)}
                       </div>
                   </div>`
                : '';

            const toggleBtn = article.inhoud
                ? `<button class="news-card-toggle" id="${id}-toggle" onclick="toggleArticle('${id}')">
                       Lees meer <span class="arrow">‚ñº</span>
                   </button>`
                : '';

            return `
                <article class="news-card" id="${id}">
                    ${imageHtml}
                    <div class="news-card-body">
                        <span class="news-card-date">üìÖ ${dateFormatted}</span>
                        <h3 class="news-card-title">${article.titel}</h3>
                        ${summaryHtml}
                        ${toggleBtn}
                        <div class="news-card-meta">
                            <span class="news-auteur-badge">${article.auteur || 'Kerngroep'}</span>
                        </div>
                    </div>
                    ${fullContentHtml}
                </article>
            `;
        }

        // Toggle article expand/collapse
        function toggleArticle(id) {
            const expand = document.getElementById(`${id}-expand`);
            const toggle = document.getElementById(`${id}-toggle`);
            if (!expand || !toggle) return;

            const isOpen = expand.classList.contains('open');
            expand.classList.toggle('open');
            toggle.classList.toggle('open');
            toggle.innerHTML = isOpen
                ? 'Lees meer <span class="arrow">‚ñº</span>'
                : 'Inklappen <span class="arrow">‚ñº</span>';
        }

        // Load news from Supabase
        async function loadNieuws() {
            const loadingEl = document.getElementById('news-loading');
            const dynamicFeed = document.getElementById('news-feed-dynamic');
            const staticFeed = document.getElementById('news-feed-static');

            // Wait for Supabase to be ready (max 2 seconds)
            let attempts = 0;
            while (!window.supabaseClient && attempts < 20) {
                await new Promise(r => setTimeout(r, 100));
                attempts++;
            }

            if (!window.supabaseClient) {
                console.warn('Supabase not available, showing static fallback');
                loadingEl.style.display = 'none';
                staticFeed.style.display = 'flex';
                return;
            }

            try {
                const { data, error } = await window.supabaseClient
                    .from('nieuws')
                    .select('*')
                    .eq('gepubliceerd', true)
                    .order('created_at', { ascending: false });

                if (error) {
                    // Table doesn't exist yet ‚Äî show static fallback
                    if (error.code === '42P01' || error.message?.includes('does not exist') || error.message?.includes('relation')) {
                        console.warn('Nieuws table not yet created, showing static fallback');
                        loadingEl.style.display = 'none';
                        staticFeed.style.display = 'flex';
                        return;
                    }
                    throw error;
                }

                loadingEl.style.display = 'none';

                if (!data || data.length === 0) {
                    // No published articles yet ‚Äî show static fallback
                    staticFeed.style.display = 'flex';
                    return;
                }

                // Render dynamic articles + show static too
                dynamicFeed.innerHTML = data.map(buildNewsCard).join('');
                dynamicFeed.style.display = 'flex';
                staticFeed.style.display = 'flex';

            } catch (err) {
                console.error('Error loading nieuws:', err);
                loadingEl.style.display = 'none';
                staticFeed.style.display = 'flex';
            }
        }

        // Init
        document.addEventListener('DOMContentLoaded', loadNieuws);

        // Lightbox functionaliteit
        const lightbox = document.getElementById('lightbox');
        const lightboxImg = document.getElementById('lightbox-img');
        
        document.addEventListener('click', (e) => {
            if (e.target.matches('.news-gallery img, .news-card-image-top')) {
                lightboxImg.src = e.target.src;
                lightbox.classList.add('active');
            }
        });
        
        lightbox.addEventListener('click', () => {
            lightbox.classList.remove('active');
        });
        
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') lightbox.classList.remove('active');
        });
    </script>
    <script src="search-index.js"></script>
    <script src="search.js"></script>

    <!-- Sidebar Menu -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="closeSidebar()"></div>
    <div class="sidebar-menu" id="sidebarMenu">
        <div class="sidebar-header">
            <span>Menu</span>
            <button class="sidebar-close" onclick="closeSidebar()" aria-label="Sluiten">&times;</button>
        </div>
        <nav class="sidebar-nav">
            <a href="index.html">Home</a>
            <a href="nieuws.html">Nieuws</a>
            <a href="kaart.html">Kaart</a>
            <div class="sidebar-divider"></div>
            <a href="over-sa.html">Ambassadeurs</a>
            <a href="over-sa.html" class="sidebar-sub">Informatie</a>
            <a href="aanmelden.html" class="sidebar-sub">Aanmelden</a>
            <a href="potje-aanvragen.html" class="sidebar-sub">Potje aanvragen</a>
            <a href="potje-afrekenen.html" class="sidebar-sub">Potje afrekenen</a>
            <div class="sidebar-divider"></div>
            <a href="over-kerngroep.html">Kerngroep</a>
            <a href="contact.html">Contact</a>
            <a href="admin.html">Beheer</a>
        </nav>
    </div>
    <script>
    function openSidebar(){document.getElementById('sidebarMenu').classList.add('active');document.getElementById('sidebarOverlay').classList.add('active');document.body.style.overflow='hidden';}
    function closeSidebar(){document.getElementById('sidebarMenu').classList.remove('active');document.getElementById('sidebarOverlay').classList.remove('active');document.body.style.overflow='';}
    </script>
</body>
</html>
